<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×’Ö´Ö¼× Ö·Ö¼×ª ×–Ö°×”Ö¸×‘Ö¸×” | ××©×—×§ ×’×™×“×•×œ ×™×¨×§×•×ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8C8 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
            transition: background 1s ease;
        }

        body.night {
            background: linear-gradient(to bottom, #1a1a2e 0%, #0f3460 100%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header with Zahava */
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 48px;
            color: #2d5016;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .zahava-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

      .zahava-image 
    width: 80px;
    height: 80px;
    border-radius: 40%;
    border: 4px solid #8B4513;
    object-fit: contain;
    background: white;
    padding: 5px;

        }

        .zahava-message {
            background: #fff3cd;
            padding: 15px 25px;
            border-radius: 20px;
            border: 3px solid #ffc107;
            font-size: 20px;
            color: #856404;
            max-width: 500px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Day Counter */
        .day-counter {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            display: none;
        }

        .day-counter.active {
            display: block;
        }

        .day-counter h2 {
            font-size: 36px;
            color: #2d5016;
            margin-bottom: 10px;
        }

        .actions-left {
            font-size: 20px;
            color: #666;
        }

        /* Garden Selection */
        .garden-selection {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .garden-selection h2 {
            text-align: center;
            font-size: 32px;
            color: #2d5016;
            margin-bottom: 20px;
        }

        .vegetable-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .veg-btn {
            background: linear-gradient(145deg, #6aa84f, #5a9840);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 24px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-weight: bold;
        }

        .veg-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .veg-btn.tomato {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
        }

        .veg-btn.cucumber {
            background: linear-gradient(145deg, #27ae60, #229954);
        }

        .veg-btn.carrot {
            background: linear-gradient(145deg, #e67e22, #d35400);
        }

        /* Garden Area */
        .garden-area {
            background: rgba(139, 69, 19, 0.3);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            min-height: 400px;
            box-shadow: inset 0 4px 10px rgba(0,0,0,0.2);
            display: none;
        }

        .garden-area.active {
            display: block;
        }

        .garden-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }

        .plant-slot {
            background: rgba(101, 67, 33, 0.6);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .plant-name {
            font-size: 24px;
            color: white;
            margin-bottom: 15px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .plant-image-container {
            width: 180px;
            height: 180px;
            margin: 0 auto 15px;
            position: relative;
        }

        .plant-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: all 0.5s ease;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }

        .plant-image.growing {
            animation: grow 1s ease-out;
        }

        @keyframes grow {
            0% {
                transform: scale(0.8) rotate(-5deg);
                opacity: 0.5;
            }
            50% {
                transform: scale(1.15) rotate(5deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .stage-info {
            color: white;
            font-size: 18px;
            margin-top: 10px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Action Buttons */
        .action-buttons {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: none;
            margin-bottom: 20px;
        }

        .action-buttons.active {
            display: block;
        }

        .action-buttons h3 {
            text-align: center;
            font-size: 28px;
            color: #2d5016;
            margin-bottom: 20px;
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .action-btn {
            padding: 25px 20px;
            font-size: 22px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-weight: bold;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .action-btn.used {
            opacity: 0.6;
            border: 3px solid #4CAF50;
        }

        .action-btn.water {
            background: linear-gradient(145deg, #3498db, #2980b9);
        }

        .action-btn.sun {
            background: linear-gradient(145deg, #f39c12, #e67e22);
        }

        .action-btn.fertilizer {
            background: linear-gradient(145deg, #27ae60, #229954);
        }

        .action-btn.love {
            background: linear-gradient(145deg, #e91e63, #c2185b);
        }

        .btn-icon {
            font-size: 32px;
            display: block;
            margin-bottom: 5px;
        }

        /* End Day Button */
        .end-day-btn {
            width: 100%;
            padding: 20px;
            font-size: 26px;
            background: linear-gradient(145deg, #8e44ad, #7d3c98);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            display: none;
        }

        .end-day-btn.active {
            display: block;
        }

        .end-day-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .end-day-btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        /* Day Night Transition */
        .day-night-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .day-night-overlay.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .transition-message {
            font-size: 48px;
            color: white;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        .moon {
            width: 100px;
            height: 100px;
            background: #f4f4f4;
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(244,244,244,0.6);
            margin-bottom: 20px;
            animation: moonGlow 2s ease-in-out infinite;
        }

        @keyframes moonGlow {
            0%, 100% { box-shadow: 0 0 40px rgba(244,244,244,0.6); }
            50% { box-shadow: 0 0 60px rgba(244,244,244,0.9); }
        }

        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .star {
            position: absolute;
            width: 3px;
            height: 3px;
            background: white;
            border-radius: 50%;
            animation: twinkle 1.5s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .sunrise {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            border-radius: 50%;
            box-shadow: 0 0 60px rgba(255,215,0,0.8);
            animation: rise 1s ease-out;
        }

        @keyframes rise {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Celebration */
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1000;
            display: none;
        }

        .celebration.active {
            display: block;
            animation: celebrate 0.5s ease-out;
        }

        @keyframes celebrate {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .celebration h2 {
            font-size: 36px;
            color: #27ae60;
            margin-bottom: 20px;
        }

        .celebration p {
            font-size: 24px;
            color: #2d5016;
            margin-bottom: 20px;
        }

        .celebration button {
            padding: 15px 40px;
            font-size: 20px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Reset Button */
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
        }

        .reset-btn:hover {
            background: #c0392b;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 32px;
            }

            .zahava-message {
                font-size: 16px;
            }

            .veg-btn {
                padding: 15px 25px;
                font-size: 20px;
            }

            .garden-grid {
                grid-template-columns: 1fr;
            }

            .transition-message {
                font-size: 32px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸŒ± ×’Ö´Ö¼× Ö·Ö¼×ª ×–Ö°×”Ö¸×‘Ö¸×” ğŸŒ±</h1>
            <div class="zahava-container">
                <img src="images/zahava.png" alt="×–×”×‘×”" class="zahava-image">
                <div class="zahava-message" id="zahavaMessage">
                    ×©Ö¸××œ×•Ö¹× ×™Ö°×œÖ¸×“Ö´×™×! ×‘Ö¼×•Ö¹××•Ö¼ × Ö°×’Ö·×“ÖµÖ¼×œ ×™Ö°×¨Ö¸×§×•Ö¹×ª ×‘Ö·Ö¼×’Ö´Ö¼× Ö¸Ö¼×” ×©Ö¶××œÖ´Ö¼×™! ğŸŒŸ
                </div>
            </div>
        </div>

        <!-- Day Counter -->
        <div class="day-counter" id="dayCounter">
            <h2>×™×•Ö¹× <span id="currentDay">1</span> ×Ö´×ªÖ¼×•Ö¹×šÖ° 6</h2>
            <div class="actions-left">
                ×¤Ö°Ö¼×¢×•Ö¼×œ×•Ö¹×ª ×©Ö¶×× Ö´Ö¼×©Ö°××Ö¸×¨×•Ö¼ ×”Ö·×™Ö¼×•Ö¹×: <strong id="actionsLeft">2</strong>
            </div>
        </div>

        <!-- Vegetable Selection -->
        <div class="garden-selection" id="vegetableSelection">
            <h2>×‘Ö·Ö¼×—Ö²×¨×•Ö¼ ×Öµ×™×–Ö¶×” ×™Ö¸×¨Ö¸×§ ×œÖ´×©Ö°××ªÖ¼×•Ö¹×œ:</h2>
            <div class="vegetable-buttons">
                <button class="veg-btn tomato" onclick="startGarden('tomato')">
                    ğŸ… ×¢Ö·×’Ö°×‘Ö¸× Ö´×™Ö¸Ö¼×”
                </button>
                <button class="veg-btn cucumber" onclick="startGarden('cucumber')">
                    ğŸ¥’ ×Ö°×œÖ¸×¤Ö°×¤×•Ö¹×Ÿ
                </button>
                <button class="veg-btn carrot" onclick="startGarden('carrot')">
                    ğŸ¥• ×’Ö¶Ö¼×–Ö¶×¨
                </button>
            </div>
        </div>

        <!-- Garden Area -->
        <div class="garden-area" id="gardenArea">
            <div class="garden-grid" id="gardenGrid">
                <!-- Plants will be added here dynamically -->
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons" id="actionButtons">
            <h3>×‘Ö·Ö¼×—Ö²×¨×•Ö¼ 2 ×¤Ö°Ö¼×¢×•Ö¼×œ×•Ö¹×ª ×œÖ·×™Ö¼×•Ö¹×:</h3>
            <div class="buttons-grid">
                <button class="action-btn water" onclick="performAction('water')" id="btn-water">
                    <span class="btn-icon">ğŸ’§</span>
                    ×”Ö·×©Ö°××§Ö¸×™Ö¸×”
                </button>
                <button class="action-btn sun" onclick="performAction('sun')" id="btn-sun">
                    <span class="btn-icon">â˜€ï¸</span>
                    ×©Ö¶××Ö¶×©×
                </button>
                <button class="action-btn fertilizer" onclick="performAction('fertilizer')" id="btn-fertilizer">
                    <span class="btn-icon">ğŸŒ±</span>
                    ×“Ö´Ö¼×©Ö¼××•Ö¼×Ÿ
                </button>
                <button class="action-btn love" onclick="performAction('love')" id="btn-love">
                    <span class="btn-icon">â¤ï¸</span>
                    ×¢Ö´×“Ö¼×•Ö¼×“
                </button>
            </div>
            <button class="end-day-btn" id="endDayBtn" onclick="endDay()" disabled>
                ğŸŒ™ ×¡Ö´×™Ö¼×•Ö¼× ×”Ö·×™Ö¼×•Ö¹× ×•Ö¼×Ö·×¢Ö²×‘Ö¸×¨ ×œÖ°×Ö¸×—Ö¸×¨
            </button>
            <button class="reset-btn" onclick="resetGarden()">ğŸ”„ ×”Ö·×ªÖ°×—Öµ×œ ×Öµ×—Ö¸×“Ö¸×©×</button>
        </div>
    </div>

    <!-- Day/Night Transition -->
    <div class="day-night-overlay" id="dayNightOverlay">
        <div class="stars" id="stars"></div>
        <div id="transitionContent"></div>
        <div class="transition-message" id="transitionMessage"></div>
    </div>

    <!-- Celebration Overlay -->
    <div class="overlay" id="overlay"></div>
    <div class="celebration" id="celebration">
        <h2>ğŸ‰ ×›Ö¸Ö¼×œ ×”Ö·×›Ö¸Ö¼×‘×•Ö¹×“! ğŸ‰</h2>
        <p id="celebrationMessage"></p>
        <button onclick="closeCelebration()">×”Ö·×Ö°×©Öµ××šÖ° ×œÖ°×’Ö·×“ÖµÖ¼×œ!</button>
        <button onclick="resetGarden()">×”Ö·×ªÖ°×—Öµ×œ ×Öµ×—Ö¸×“Ö¸×©×</button>
    </div>

    <script>
        // Game State
        let currentVegetable = null;
        let plants = [];
        let currentDay = 1;
        let actionsToday = 0;
        let todaysActions = [];

        // Vegetable configurations
        const vegetables = {
            tomato: {
                name: '×¢Ö·×’Ö°×‘Ö¸× Ö´×™Ö¸Ö¼×”',
                stages: [
                    { name: '×–Ö¶×¨Ö·×¢', image: 'images/tomato-seed.png', day: 1 },
                    { name: '× Ö¶×‘Ö¶×˜', image: 'images/tomato-sprout.png', day: 3 },
                    { name: '×¦Ö¶×Ö·×— ×¦Ö¸×¢Ö´×™×¨', image: 'images/tomato-plant.png', day: 5 },
                    { name: '×¢Ö·×’Ö°×‘Ö¸× Ö´×™Ö¸Ö¼×” ×‘Ö°Ö¼×©Öµ××œÖ¸×”', image: 'images/tomato-full.png', day: 7 }
                ]
            },
            cucumber: {
                name: '×Ö°×œÖ¸×¤Ö°×¤×•Ö¹×Ÿ',
                stages: [
                    { name: '×–Ö¶×¨Ö·×¢', image: 'images/cucumber-seed.png', day: 1 },
                    { name: '× Ö¶×‘Ö¶×˜', image: 'images/cucumber-sprout.png', day: 3 },
                    { name: '×¦Ö¶×Ö·×— ×¦Ö¸×¢Ö´×™×¨', image: 'images/cucumber-plant.png', day: 5 },
                    { name: '×Ö°×œÖ¸×¤Ö°×¤×•Ö¹×Ÿ ×‘Ö¸Ö¼×©Öµ××œ', image: 'images/cucumber-full.png', day: 7 }
                ]
            },
            carrot: {
                name: '×’Ö¶Ö¼×–Ö¶×¨',
                stages: [
                    { name: '×–Ö¶×¨Ö·×¢', image: 'images/carrot-seed.png', day: 1 },
                    { name: '× Ö¶×‘Ö¶×˜', image: 'images/carrot-sprout.png', day: 3 },
                    { name: '×¦Ö¶×Ö·×— ×¦Ö¸×¢Ö´×™×¨', image: 'images/carrot-plant.png', day: 5 },
                    { name: '×’Ö¶Ö¼×–Ö¶×¨ ×‘Ö¸Ö¼×©Öµ××œ', image: 'images/carrot-full.png', day: 7 }
                ]
            }
        };

        // Messages from Zahava
        const zahavaMessages = {
            start: '×‘Ö·Ö¼×—Ö²×¨×•Ö¼ 2 ×¤Ö°Ö¼×¢×•Ö¼×œ×•Ö¹×ª ×œÖ·×™Ö¼×•Ö¹× ×”Ö¸×¨Ö´××©××•Ö¹×Ÿ!',
            firstAction: '×™Ö¸×¤Ö¶×” ×Ö°××•Ö¹×“! ×¢×•Ö¹×“ ×¤Ö°Ö¼×¢×•Ö¼×œÖ¸×” ×Ö·×—Ö·×ª! ğŸ‘',
            readyForDay: '××•Ö¼×›Ö¸× Ö´×™× ×œÖ°×¡Ö·×™ÖµÖ¼× ×Ö¶×ª ×”Ö·×™Ö¼×•Ö¹×? ğŸŒ™',
            morning: '×‘Ö¼×•Ö¹×§Ö¶×¨ ×˜×•Ö¹×‘! ×™×•Ö¹× ×—Ö¸×“Ö¸×©× ×‘Ö·Ö¼×’Ö´Ö¼× Ö¸Ö¼×”! â˜€ï¸',
            needWater: '×Ö·×œ ×ªÖ´Ö¼×©Ö°××›Ö°Ö¼×—×•Ö¼ ×œÖ¸×ªÖµ×ª ×Ö·×™Ö´× ×œÖ·×¦Ö°Ö¼×Ö¸×—Ö´×™×! ğŸ’§',
            needSun: '×”Ö·×¦Ö°Ö¼×Ö¸×—Ö´×™× ×¦Ö°×¨Ö´×™×›Ö´×™× ×©Ö¶××Ö¶×©×! â˜€ï¸',
            needFertilizer: '×Ö¸×” ×“Ö·Ö¼×¢Ö°×ªÖ°Ö¼×›Ö¶× ×¢Ö·×œ ×§Ö°×¦Ö·×ª ×“Ö¶Ö¼×©Ö¶××Ÿ? ğŸŒ±',
            needLove: '×Ö·×”Ö²×‘Ö¸×” ×•Ö°×¢Ö´×“Ö¼×•Ö¼×“ ×—Ö²×©××•Ö¼×‘Ö´×™× ×Ö°××•Ö¹×“! â¤ï¸',
            growing: '×”Ö·×¦Ö°Ö¼×Ö¸×—Ö´×™× ×’Ö°Ö¼×“Öµ×œÖ´×™×! ×ªÖ´Ö¼×¡Ö°×ªÖ·Ö¼×›Ö°Ö¼×œ×•Ö¼ ×›Ö·Ö¼×Ö¸×” ×™Ö¸×¤Ö¶×”! ğŸŒŸ',
            almostDone: '×¢×•Ö¹×“ ×Ö°×¢Ö·×˜ ×•Ö°×”Öµ× ×™Ö´×”Ö°×™×•Ö¼ ×‘Ö°Ö¼×©Öµ××œÖ´×™×! ğŸŠ',
            final: '×Ö·×–Ö¸Ö¼×œ ×˜×•Ö¹×‘! ×”Ö·×™Ö°×¨Ö¸×§×•Ö¹×ª ×‘Ö°Ö¼×©Öµ××œÖ´×™× ×œÖ°×’Ö·×Ö°×¨Öµ×™! ğŸ‰'
        };

        function startGarden(vegetableType) {
            currentVegetable = vegetableType;
            currentDay = 1;
            actionsToday = 0;
            todaysActions = [];
            plants = [];

            // Create 3 plant slots
            for (let i = 0; i < 3; i++) {
                plants.push({
                    id: i,
                    type: vegetableType,
                    stage: 0
                });
            }

            renderGarden();
            document.getElementById('vegetableSelection').style.display = 'none';
            document.getElementById('gardenArea').classList.add('active');
            document.getElementById('actionButtons').classList.add('active');
            document.getElementById('dayCounter').classList.add('active');
            
            updateDayCounter();
            updateZahavaMessage(zahavaMessages.start);
        }

        function renderGarden() {
            const grid = document.getElementById('gardenGrid');
            grid.innerHTML = '';

            plants.forEach(plant => {
                const vegConfig = vegetables[plant.type];
                const currentStage = vegConfig.stages[plant.stage];

                const slot = document.createElement('div');
                slot.className = 'plant-slot';
                slot.innerHTML = `
                    <div class="plant-name">${vegConfig.name} ${plant.id + 1}</div>
                    <div class="plant-image-container">
                        <img src="${currentStage.image}" alt="${currentStage.name}" class="plant-image" id="plant-img-${plant.id}">
                    </div>
                    <div class="stage-info">${currentStage.name}</div>
                `;
                grid.appendChild(slot);
            });
        }

        function performAction(actionType) {
            if (actionsToday >= 2) return;

            actionsToday++;
            todaysActions.push(actionType);

            // Mark button as used
            const btn = document.getElementById(`btn-${actionType}`);
            btn.classList.add('used');
            btn.disabled = true;

            // Update counter and message
            updateDayCounter();

            if (actionsToday === 1) {
                updateZahavaMessage(zahavaMessages.firstAction);
            } else if (actionsToday === 2) {
                updateZahavaMessage(zahavaMessages.readyForDay);
                document.getElementById('endDayBtn').disabled = false;
                document.getElementById('endDayBtn').classList.add('active');
                
                // Disable all action buttons
                disableAllActionButtons();
            }
        }

        function disableAllActionButtons() {
            ['water', 'sun', 'fertilizer', 'love'].forEach(action => {
                document.getElementById(`btn-${action}`).disabled = true;
            });
        }

        function enableActionButtons() {
            ['water', 'sun', 'fertilizer', 'love'].forEach(action => {
                const btn = document.getElementById(`btn-${action}`);
                btn.disabled = false;
                btn.classList.remove('used');
            });
        }

        function updateDayCounter() {
            document.getElementById('currentDay').textContent = currentDay;
            document.getElementById('actionsLeft').textContent = 2 - actionsToday;
        }

        function endDay() {
            // Show night transition
            showNightTransition(() => {
                // Advance day
                currentDay++;
                actionsToday = 0;
                
                // Check for balance and give advice
                const advice = getBalanceAdvice();
                
                // Check if plants should grow
                checkPlantGrowth();
                
                // Reset for new day
                todaysActions = [];
                enableActionButtons();
                document.getElementById('endDayBtn').disabled = true;
                document.getElementById('endDayBtn').classList.remove('active');
                updateDayCounter();

                // Show morning transition
                setTimeout(() => {
                    showMorningTransition(() => {
                        if (currentDay > 6) {
                            // Game complete!
                            showFinalCelebration();
                        } else {
                            updateZahavaMessage(advice || zahavaMessages.morning);
                        }
                    });
                }, 2000);
            });
        }

        function checkPlantGrowth() {
            const vegConfig = vegetables[currentVegetable];
            
            plants.forEach(plant => {
                // Check if we should advance to next stage
                for (let i = plant.stage + 1; i < vegConfig.stages.length; i++) {
                    if (currentDay >= vegConfig.stages[i].day) {
                        plant.stage = i;
                        
                        // Trigger grow animation
                        setTimeout(() => {
                            const img = document.getElementById(`plant-img-${plant.id}`);
                            if (img) {
                                img.classList.add('growing');
                                setTimeout(() => img.classList.remove('growing'), 1000);
                            }
                        }, 100);
                    }
                }
            });

            renderGarden();

            // Update Zahava message based on progress
            if (currentDay === 3) {
                setTimeout(() => updateZahavaMessage(zahavaMessages.growing), 3000);
            } else if (currentDay === 5) {
                setTimeout(() => updateZahavaMessage(zahavaMessages.almostDone), 3000);
            }
        }

        function getBalanceAdvice() {
            // Count action types
            const actionCounts = {
                water: 0,
                sun: 0,
                fertilizer: 0,
                love: 0
            };

            todaysActions.forEach(action => {
                actionCounts[action]++;
            });

            // Give advice if something is missing completely
            const unused = Object.keys(actionCounts).filter(key => actionCounts[key] === 0);
            
            if (unused.length > 0) {
                const randomUnused = unused[Math.floor(Math.random() * unused.length)];
                return zahavaMessages[`need${randomUnused.charAt(0).toUpperCase() + randomUnused.slice(1)}`];
            }

            return null;
        }

        function showNightTransition(callback) {
            const overlay = document.getElementById('dayNightOverlay');
            const message = document.getElementById('transitionMessage');
            const content = document.getElementById('transitionContent');
            
            // Create stars
            const starsContainer = document.getElementById('stars');
            starsContainer.innerHTML = '';
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }

            // Show moon
            content.innerHTML = '<div class="moon"></div>';
            message.textContent = 'ğŸŒ™ ×”Ö·×œÖ·Ö¼×™Ö°×œÖ¸×” ×¢×•Ö¹×‘Öµ×¨... ğŸ’¤';
            
            document.body.classList.add('night');
            overlay.classList.add('active');

            setTimeout(() => {
                overlay.classList.remove('active');
                if (callback) callback();
            }, 2000);
        }

        function showMorningTransition(callback) {
            const overlay = document.getElementById('dayNightOverlay');
            const message = document.getElementById('transitionMessage');
            const content = document.getElementById('transitionContent');
            
            // Show sunrise
            content.innerHTML = '<div class="sunrise"></div>';
            message.textContent = 'ğŸŒ… ×‘Ö¼×•Ö¹×§Ö¶×¨ ×˜×•Ö¹×‘! ×™×•Ö¹× ×—Ö¸×“Ö¸×©×! â˜€ï¸';
            
            overlay.classList.add('active');

            setTimeout(() => {
                document.body.classList.remove('night');
                overlay.classList.remove('active');
                if (callback) callback();
            }, 2000);
        }

        function showFinalCelebration() {
            const vegName = vegetables[currentVegetable].name;
            document.getElementById('celebrationMessage').innerHTML = `
                ×”Ö·×¦Ö°×œÖ·×—Ö°×ªÖ¶Ö¼×! ×›Ö¸Ö¼×œ ×”Ö·×™Ö°Ö¼×¨Ö¸×§×•Ö¹×ª ×‘Ö°Ö¼×©Öµ××œÖ´×™× ×œÖ°×’Ö·×Ö°×¨Öµ×™!<br>
                ×Ö·×ªÖ¶Ö¼× ×’Ö·Ö¼× Ö¸Ö¼× Ö´×™× ×Ö°×¢Ö»×œÖ´Ö¼×™×! ğŸŒŸ
            `;
            document.getElementById('celebration').classList.add('active');
            document.getElementById('overlay').classList.add('active');

            updateZahavaMessage(zahavaMessages.final);
        }

        function closeCelebration() {
            document.getElementById('celebration').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        function updateZahavaMessage(message) {
            document.getElementById('zahavaMessage').textContent = message;
        }

        function resetGarden() {
            if (confirm('×”Ö¸×Ö´× ×Ö·×ªÖ¶Ö¼× ×‘Ö°Ö¼×˜×•Ö¼×—Ö´×™× ×©Ö¶××Ö·×ªÖ¶Ö¼× ×¨×•Ö¹×¦Ö´×™× ×œÖ°×”Ö·×ªÖ°×—Ö´×™×œ ×Öµ×—Ö¸×“Ö¸×©×?')) {
                document.getElementById('gardenArea').classList.remove('active');
                document.getElementById('actionButtons').classList.remove('active');
                document.getElementById('dayCounter').classList.remove('active');
                document.getElementById('vegetableSelection').style.display = 'block';
                document.body.classList.remove('night');
                closeCelebration();
                updateZahavaMessage('×©Ö¸××œ×•Ö¹× ×™Ö°×œÖ¸×“Ö´×™×! ×‘Ö¼×•Ö¹××•Ö¼ × Ö°×’Ö·×“ÖµÖ¼×œ ×™Ö°×¨Ö¸×§×•Ö¹×ª ×‘Ö·Ö¼×’Ö´Ö¼× Ö¸Ö¼×” ×©Ö¶××œÖ´Ö¼×™! ğŸŒŸ');
            }
        }
    </script>
</body>
</html>
